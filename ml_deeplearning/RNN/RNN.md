## 循环神经网络
常用的神经网络结构————循环神经网络(RNN),以及循环神经网络的一个重要结构----长短时记忆网络(Long short-trem memory,
LSTM), 介绍循环神经网络在自然语言处理(NLP)问题以及时许分析问题中的应用，并给出具体的Tensorflow程序来解决一些经典问题。

### 8.1 循环神经网络简介
RNN源于1982年由Saratha Sathasivam提出的霍普菲尔德网络。传统的机器学习算法非常依赖于人工特征的提取，使得基于传统
机器学习的图像识别、语音识别以及自然语言处理问题存在特征提取的瓶颈。而基于全连接神经网络的方法也存在参数太多、无法利用数据中时间
序列信息等问题。随着更加有效的循环神经网络结构被不断提出，循环神经网络挖掘数据中的时序信息以及语义信息的深度表达能力被充分
利用，并在语音识别、语言模型、机器翻译以及时序分析等方面做了突破。

循环神经网络的主要用途是处理和预测序列数据。在之前介绍的全连接神经网络或卷积神经网络模型中，网络结构都是
从输入层到隐含层再到输出层，层与层之间是全连接或部分连接的，但每层之间的节点是无连接的。
如果要预测句子的下一个单词是什么，一般需要用到当前单词以及前面的单词，因为句子中前后单词并不是独立的。

    循环神经网络的来源就是为了刻画一个序列当前的输出与之前信息的关系。从网络结构上，循环神经网络会记忆之前的信息，
    并利用之前的信息影响后面节点的输出，也就是说，循环神经网络的隐藏层之间的节点是由联结的，隐藏层的输入不仅包含输入层的的输出，
    还包括上一时刻隐藏层的输出。
    
    循环神经网络理论上可以被看作是同一神经网络结构被无限复制的结果。但处于优化考虑，目前循环神网络无法做到真正的无限循环.
    
    RNN这种网络结构的特点之一就是网络的状态仅依赖于输入，而RNN的状态不仅依赖于输入，且与网络上一时刻的状态有关。
    
    对于一个序列数据，可以将这个序列上不同时刻的数据依次传入循环神经网络的输入层，而输出可以使一对对序列中下一个
    时刻的预测，也可以是对当前时刻信息的处理结果。循环神经网络要求每一个时刻都有一个输入，但是不一定都有一个输出。
    
    书中的例子解释RNN过程：
    state: [ 0.53704957  0.46211716]
    output: [ 1.56128388]
    before activation: [ 1.64579508  1.64579508]
    state: [ 0.92827835  0.92827835]
    output: [ 2.88483504]
    
    在定义完损失函数后，就可以利用第四章的优化框架TF自动实完成模型优化训练的过程，理论上循环神经网络
    可以支持任意长度的序列，实际中，如果序列过长会导致优化时出现阶梯消散的问题，实际中一般会规定一个
    最大长度，当序列超过规则长度之后会对序列进行截断。
    

### 长短时记忆网络(LSTM)结构
循环神经网络工作的关键点就是使用历史的信息来帮助当前的决策。例如之前出现的单词来加强对当前文字的理解。循环
神经网络可以更好的利用神经网络结果所不能建模的信息，但同时也带来了更大的技术挑战—— 长期依赖(long-term dependencies)问题

长期依赖和短期依赖有不同的适应环境。

    长短时记忆网络(LSTM)的设计就是为了这个问题，而循环设计玩过被成功应用的关键是LSTM。在很多任务上，采用LSTM
    结构的循环神经网络表现更好。
    LSTM是一种拥有三个门结构的特殊网络结构
    LSTM靠一些门的结构让信息有选择性的影响循环神经网络中每个时刻的状态。所谓“门”的结构就是一个使用sigmoid神经网络
    和一个按位做乘法的操作，这两个操作合在一起就是一个门的结构。门打开时，全部信息都可以通过；门关闭时，任何信息都无法通过。
    
    遗忘门的作用是让循环神经网络忘记之前没有用的信息，比如一段文章中某地原先是绿水蓝天，但后来被污染了。于是
    在看到被污染了之后，循环门应该忘记之前绿水蓝天的状态。这个工作是通过遗忘门来完成的，“遗忘门”会根据当前的输入xt
    上一时刻状态ct-1和上一时刻输出ht-1共同决定哪一部分记忆需要被遗忘。在循环神经网络“忘记”了部分之前的状态后，
    还需要从当前的输入补充最新的记忆。这个过程就是"输入门"完成的，“输入门”会根据xt,ct-1,ht-1决定哪些部分将进入当前时刻的状态ct
    比如看到文章中提到环境被污染之后，模型需要将这个信息写入新的状态。通过“遗忘门”和“输入门”，LSTM结构
    可以更加有效的决定哪些信息应该被以往，哪些信息应该得到保留。
    